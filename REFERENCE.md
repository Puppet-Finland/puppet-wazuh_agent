# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

#### Public Classes

* [`wazuh_agent`](#wazuh_agent): Manage Wazuh agent

#### Private Classes

* `wazuh_agent::config`: Configure and supervise Wazuh agent
* `wazuh_agent::ensure_absent`: Completely remove wazuh agent from the system
* `wazuh_agent::install`: Install Wazuh agent
* `wazuh_agent::install::apt`: Manage apt repo
* `wazuh_agent::install::yum`: Manage yum repo
* `wazuh_agent::service`: Manage Wazuh agent service
* `wazuh_agent::supervise`: supervise Wazuh agent

### Functions

* [`wazuh_agent::api_agent_exists`](#wazuh_agent--api_agent_exists)

## Classes

### <a name="wazuh_agent"></a>`wazuh_agent`

Manage Wazuh agent

* **See also**
  * https://documentation.wazuh.com/current/user-manual/reference/ossec-conf/client.html?highlight=enrollment#enrollment
  * data/common.yaml
    * for default values.

#### Examples

##### Basic usage

```puppet

class { wazuh_agent:
  enrollment_server   => 'mywazuh.example.com',
  enrollment_password => 'created_with_enigma',
}
```

#### Parameters

The following parameters are available in the `wazuh_agent` class:

* [`version`](#-wazuh_agent--version)
* [`revision`](#-wazuh_agent--revision)
* [`repo_name`](#-wazuh_agent--repo_name)
* [`agent_name`](#-wazuh_agent--agent_name)
* [`enrollment_server`](#-wazuh_agent--enrollment_server)
* [`enrollment_server_port`](#-wazuh_agent--enrollment_server_port)
* [`enrollment_password`](#-wazuh_agent--enrollment_password)
* [`management_server`](#-wazuh_agent--management_server)
* [`management_server_port`](#-wazuh_agent--management_server_port)
* [`package_name`](#-wazuh_agent--package_name)
* [`service_name`](#-wazuh_agent--service_name)
* [`service_ensure`](#-wazuh_agent--service_ensure)
* [`service_enable`](#-wazuh_agent--service_enable)
* [`last_ack_limit`](#-wazuh_agent--last_ack_limit)
* [`keepalive_limit`](#-wazuh_agent--keepalive_limit)
* [`debug`](#-wazuh_agent--debug)
* [`check_api`](#-wazuh_agent--check_api)
* [`api_host`](#-wazuh_agent--api_host)
* [`api_host_port`](#-wazuh_agent--api_host_port)
* [`api_username`](#-wazuh_agent--api_username)
* [`api_password`](#-wazuh_agent--api_password)
* [`check_status`](#-wazuh_agent--check_status)
* [`check_keepalive`](#-wazuh_agent--check_keepalive)
* [`check_last_ack`](#-wazuh_agent--check_last_ack)
* [`rootcheck_disabled`](#-wazuh_agent--rootcheck_disabled)
* [`open_scap_disabled`](#-wazuh_agent--open_scap_disabled)
* [`cis_cat_disabled`](#-wazuh_agent--cis_cat_disabled)
* [`osquery_disabled`](#-wazuh_agent--osquery_disabled)
* [`syscollector_disabled`](#-wazuh_agent--syscollector_disabled)
* [`syscheck_disabled`](#-wazuh_agent--syscheck_disabled)
* [`active_response_disabled`](#-wazuh_agent--active_response_disabled)
* [`ensure_absent`](#-wazuh_agent--ensure_absent)

##### <a name="-wazuh_agent--version"></a>`version`

Data type: `String[1]`

Wazuh agent version. Default 4.3.5.

##### <a name="-wazuh_agent--revision"></a>`revision`

Data type: `String[1]`

Wazuh agent revision. Default '-1'

##### <a name="-wazuh_agent--repo_name"></a>`repo_name`

Data type: `String[1]`

Wazuh repository name. Default is 'wazuh-puppet'

##### <a name="-wazuh_agent--agent_name"></a>`agent_name`

Data type: `String[1]`

An arbitrary string for agent name. Default is facts[fqdn].

##### <a name="-wazuh_agent--enrollment_server"></a>`enrollment_server`

Data type: `String[1]`

The enrollment server name.

##### <a name="-wazuh_agent--enrollment_server_port"></a>`enrollment_server_port`

Data type: `Integer`

the enrollment server port. Default 1515.

##### <a name="-wazuh_agent--enrollment_password"></a>`enrollment_password`

Data type: `Variant[Sensitive[String[1]],String[1]]`

The password to register and enroll the agent.

##### <a name="-wazuh_agent--management_server"></a>`management_server`

Data type: `Optional[String[1]]`

The management server name.

##### <a name="-wazuh_agent--management_server_port"></a>`management_server_port`

Data type: `Integer`

The management server port.

##### <a name="-wazuh_agent--package_name"></a>`package_name`

Data type: `String[1]`

The package name. Default is 'wazuh-agent'.

##### <a name="-wazuh_agent--service_name"></a>`service_name`

Data type: `String[1]`

The service name. Default is 'wazuh-agent.service'.

##### <a name="-wazuh_agent--service_ensure"></a>`service_ensure`

Data type: `String[1]`

The service state propety. Default is 'running'.

##### <a name="-wazuh_agent--service_enable"></a>`service_enable`

Data type: `Boolean`

The service enable propety. Default is true.

##### <a name="-wazuh_agent--last_ack_limit"></a>`last_ack_limit`

Data type: `Integer`

Time in seconds since last_ack after which
to try restarting and reconnecting. Default is 300.

##### <a name="-wazuh_agent--keepalive_limit"></a>`keepalive_limit`

Data type: `Integer`

Time in seconds since last keepalive after which
to try restarting and reconnecting. Default is 300.

##### <a name="-wazuh_agent--debug"></a>`debug`

Data type: `Boolean`

Enable some agent side debugging. Default is false.

##### <a name="-wazuh_agent--check_api"></a>`check_api`

Data type: `Boolean`

Whether to check if agent exists via API
and reauthenticate if it's doesn't. Default is false.

##### <a name="-wazuh_agent--api_host"></a>`api_host`

Data type: `Optional[Stdlib::Host]`

API host. Reguired for check_api.
Note that this uses custom function that is
run on the server. Measures have been taken to
try to minimize the number of calls. The default
limit for api calls on the server is 900/min.

##### <a name="-wazuh_agent--api_host_port"></a>`api_host_port`

Data type: `Optional[Stdlib::Port]`

API host port. Reguired for check_api.

##### <a name="-wazuh_agent--api_username"></a>`api_username`

Data type: `Optional[String]`

API username. Reguired for check_api.

##### <a name="-wazuh_agent--api_password"></a>`api_password`

Data type: `Optional[String]`

API password. Reguired for check_api.

##### <a name="-wazuh_agent--check_status"></a>`check_status`

Data type: `Boolean`

Whether to monitor agent connection status. Default is true.

##### <a name="-wazuh_agent--check_keepalive"></a>`check_keepalive`

Data type: `Boolean`

Whether to monitor last keepalive. Default is false.

##### <a name="-wazuh_agent--check_last_ack"></a>`check_last_ack`

Data type: `Boolean`

Whether to monitor time since last_ack. Default is false.

##### <a name="-wazuh_agent--rootcheck_disabled"></a>`rootcheck_disabled`

Data type: `Enum['yes', 'no']`

Whether to disable rootcheck. Default yes.

##### <a name="-wazuh_agent--open_scap_disabled"></a>`open_scap_disabled`

Data type: `Enum['yes', 'no']`

Whether to disable rootcheck. Default yes.

##### <a name="-wazuh_agent--cis_cat_disabled"></a>`cis_cat_disabled`

Data type: `Enum['yes', 'no']`

Whether to disable cis-cat. Default yes.

##### <a name="-wazuh_agent--osquery_disabled"></a>`osquery_disabled`

Data type: `Enum['yes', 'no']`

Whether to disable osquery. Default yes.

##### <a name="-wazuh_agent--syscollector_disabled"></a>`syscollector_disabled`

Data type: `Enum['yes', 'no']`

Whether to disable syscollector. Default yes.

##### <a name="-wazuh_agent--syscheck_disabled"></a>`syscheck_disabled`

Data type: `Enum['yes', 'no']`

Whether to disable syscheck. Default yes.

##### <a name="-wazuh_agent--active_response_disabled"></a>`active_response_disabled`

Data type: `Enum['yes', 'no']`

Whether to disable active-response. Default yes.

##### <a name="-wazuh_agent--ensure_absent"></a>`ensure_absent`

Data type: `Boolean`

Whether to completely remove the agent. Default false (surprise).

## Functions

### <a name="wazuh_agent--api_agent_exists"></a>`wazuh_agent::api_agent_exists`

Type: Ruby 4.x API

The wazuh_agent::api_agent_exists function.

#### `wazuh_agent::api_agent_exists(String $api_host, Integer $api_host_port, String $api_username, String $api_password, String $api_agent_name)`

The wazuh_agent::api_agent_exists function.

Returns: `Boolean` Returns a boolean

##### `api_host`

Data type: `String`

API host

##### `api_host_port`

Data type: `Integer`

API host port

##### `api_username`

Data type: `String`

API username

##### `api_password`

Data type: `String`

API password

##### `api_agent_name`

Data type: `String`

API agent name

